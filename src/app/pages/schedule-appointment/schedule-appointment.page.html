<ion-header>
  <ion-toolbar class="bg-lightPeach">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/search-psychologist" class="text-lavender"></ion-back-button>
    </ion-buttons>
    <ion-title class="text-lavender font-bold">Reservar cita</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="bg-lightPeach p-4 flex flex-col">

  <!-- 📅 Semana con franjas horarias -->
  <div *ngIf="weeklyAvailability | keyvalue as days" class="space-y-4 mb-6">
    <div *ngFor="let day of days">
      <p class="font-semibold text-gray-700 mb-1">{{ day.key | date: 'EEEE, d MMMM' }}</p>

      <div *ngIf="day.value.length > 0; else noSlots" class="flex flex-wrap gap-2">
        <button
          *ngFor="let time of day.value"
          (click)="selectedDate = day.key; selectedTime = time"
          [ngClass]="selectedDate === day.key && selectedTime === time
            ? 'bg-lavender text-white'
            : 'bg-white text-gray-900'"
          class="px-3 py-1 border border-lavender rounded-full shadow-sm text-sm"
        >
          {{ time }}
        </button>
      </div>

      <ng-template #noSlots>
        <p class="text-sm text-gray-500 italic">No disponible</p>
      </ng-template>
    </div>
  </div>

  <!-- ℹ️ Info de cita seleccionada -->
  <div *ngIf="selectedDate && selectedTime" class="bg-white rounded-2xl shadow p-4 flex justify-between items-center mb-4">
    <div>
      <p class="text-lg font-bold text-gray-900">
        Consulta de {{ psychologist?.name }} {{ psychologist?.last_name }}
      </p>
      <p class="text-sm text-gray-600">
        {{ selectedTime }} – {{ computeEndTime(selectedTime) }} ({{ selectedDate }})
      </p>
    </div>
    <div class="text-right">
      <p class="text-xl font-bold text-salmon">23,50 €+</p>
      <p class="text-xs text-gray-600">60 min</p>
    </div>
  </div>

  <div class="flex-1"></div>
</ion-content>

<ion-footer translucent>
  <ion-toolbar class="bg-white border-t-2 border-salmon">
    <div class="flex justify-between items-center w-full p-4">
      <div>
        <p class="text-xl font-bold text-salmon">23,50 €+</p>
        <p class="text-sm text-gray-600">60 min</p>
      </div>
      <ion-button
        expand="block"
        class="bg-salmon"
        [disabled]="!selectedTime"
        (click)="confirm()"
      >
        <span class="text-white font-bold">Continuar</span>
      </ion-button>
    </div>
  </ion-toolbar>
</ion-footer>
